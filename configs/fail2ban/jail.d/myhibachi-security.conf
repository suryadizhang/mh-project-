# My Hibachi Security Hardening - Permanent Ban Configuration
# Created: 2025-01-30
# Purpose: Permanent bans for critical security violations

# ==========================================
# API ATTACK PROTECTION (PERMANENT BAN)
# ==========================================
[myhibachi-api]
enabled = true
port = http,https
filter = myhibachi-api
logpath = /var/log/nginx/*access*.log
maxretry = 2
# PERMANENT BAN (-1 = forever)
bantime = -1
findtime = 86400
action = %(action_mwl)s

# ==========================================
# DATABASE PROBE PROTECTION (PERMANENT BAN)
# ==========================================
[myhibachi-database]
enabled = true
port = http,https
filter = myhibachi-database
logpath = /var/log/nginx/*access*.log
maxretry = 1
# PERMANENT BAN (-1 = forever)
bantime = -1
findtime = 86400
action = %(action_mwl)s

# ==========================================
# RECIDIVE V2 - Hardcore Repeat Offenders (PERMANENT)
# ==========================================
# Anyone banned 3+ times gets banned forever
# Uses built-in recidive filter
[recidive-permanent]
enabled = true
filter = recidive
logpath = /var/log/fail2ban.log
banaction = firewallcmd-allports
# PERMANENT BAN
bantime = -1
findtime = 604800
maxretry = 3
action = %(action_mwl)s
